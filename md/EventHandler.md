ğŸ“Œ ì´ë²¤íŠ¸ ê¸°ë°˜ í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
-
AOP ë€. Aspect-Oriented Programming ì˜ ì•½ìë¡œ ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì´ë€ ëœ»ì´ë‹¤.   
ë³´ì•ˆ, íŠ¸ëœì ì…˜ ë“±ë“± í”„ë¡œê·¸ë˜ë°ì—ì„œ ì‹œìŠ¤í…œì ì¸ ê´€ì‹¬ì‚¬ë¥¼ ë³„ë„ë¡œ ë³´ê³  ê¸°ì¡´ì˜ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ê³¼ ë¶„ë¦¬í•´ì„œ ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.   
ì´ë²¤íŠ¸ ê¸°ë°˜ í”„ë¡œê·¸ë˜ë°ì€ ì´ëŸ° ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì˜ ì¼ì¢…ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.
 

ì´ë²¤íŠ¸ ê¸°ë°˜ í”„ë¡œê·¸ë˜ë°ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ê²ƒì€ ì—ëŸ¬ ì²˜ë¦¬ì— ê´€ë ¨í•œ ê²ƒì´ë‹¤. 

> ìƒí™©
* ipë¥¼ ì´ìš©í•´ì„œ íšŒì›ê°€ì…í•˜ëŠ” ì„œë¹„ìŠ¤ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì. ì´ë•Œ ê²Œì‹œíŒì„ í•˜ë‚˜ ì‘ì„±í•˜ëŠ”ë°, ì˜¤ì§ íšŒì›ë§Œ ê²Œì‹œíŒì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

ìœ„ì™€ ê°™ì€ ìƒí™©ì—ì„œ ì•„ë˜ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. (ì•„ë˜ ì½”ë“œëŠ” ì˜¤ì§ ì˜ˆì‹œì¼ ë¿ì´ë‹¤.)

```java
String ip = request.getParameter("ip");

userRepository.findByIpAddress(ip)
    .orElseThrow(() -> new UserNotFoundException("íšŒì›ì´ ì•„ë‹™ë‹ˆë‹¤."));

boardRepository.save(
    ... ì¤‘ëµ
) 
```

íšŒì›ì´ ì•„ë‹Œ ì‚¬ëŒì´ ê¸€ì„ ì‘ì„±í•  ê²½ìš° UserNotFoundException ì„ ë°œìƒì‹œí‚¬ ê²ƒì´ê³ , 
ì˜ ì‘ì„±ëœ ì„œë²„ ì½”ë“œë¼ë©´, í•´ë‹¹ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¥¼ ë§ˆë ¨í•´ë‘ì—ˆì„ ê²ƒì´ë‹¤.

ì! ì—¬ê¸°ì„œ íŒíŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.
ì´ë²¤íŠ¸ ê¸°ë°˜ í”„ë¡œê·¸ë˜ë°ì˜ ì „ì²´ì ì¸ íë¦„ì€ ì•„ë˜ì™€ ê°™ë‹¤.
1. ì´ë²¤íŠ¸ í´ë˜ìŠ¤ ì‘ì„±
2. íŠ¹ì • ìƒí™©ì—ì„œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œí‚¤ê¸°(ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” ìƒí™©ìœ¼ë¡œ ê°€ì •í•˜ë©´ throw new UserNotFoundException ì˜ ìƒí™©ê³¼ ë™ì¼) (ApplicationEventPublisher ì¸í„°í˜ì´ìŠ¤ë¥¼ implements í•´ì•¼ í•˜ëŠ”ë°  ApplicationContext í´ë˜ìŠ¤ê°€ ì´ë¯¸ ìƒì†í•˜ê³  ìˆìœ¼ë¯€ë¡œ ê·¸ê²ƒì„ ì‚¬ìš©í•´ë„ ëœë‹¤.)
3. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì‘ì„±í•´ì„œ ì´ë²¤íŠ¸ ë°œìƒì‹œ ì²˜ë¦¬

ì ì´ì œ íë¦„ì€ ì•Œì•˜ìœ¼ë‹ˆ, ì´ì œ ì‘ì„±í•´ë³´ì!


<br/>

ğŸ“Œ ì˜ˆì œ ì½”ë“œ
- 
> ìƒí™©
* íŒŒì¼ ì—…ë¡œë“œ ë„ì¤‘ ì—ëŸ¬ê°€ ë°œìƒ í–ˆì„ ë•Œ, ì—…ë¡œë“œ ëœ íŒŒì¼ì„ ì‚­ì œ ì²˜ë¦¬í•œë‹¤.

1. íŒŒì¼ ì´ë²¤íŠ¸ í´ë˜ìŠ¤ ì‘ì„±
```java

/**
 * íŒŒì¼ ì—…ë¡œë“œ ë„ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ, íŒŒì¼ì„ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ í´ë˜ìŠ¤
 * */
public class FileEvent {
    private List<FileVO> files;

    public FileEvent(List<FileVO> files) {
        this.files = files;
    }

    public List<FileVO> getFiles() {
        return files;
    }

    public FileEvent setFiles(List<FileVO> files) {
        this.files = files;
        return this;
    }
}
```
íŒŒì¼ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ìœ„í•´, ì´ë²¤íŠ¸ í´ë˜ìŠ¤ ë‚´ë¶€ì— FileVOë¥¼ ë°›ì•„ ë‘˜ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•œë‹¤. 

2. íŒŒì¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
```java
/**
 * íŒŒì¼ ì´ë²¤íŠ¸ ì²˜ë¦¬ê¸°
 * */
@Component
@RequiredArgsConstructor
public class FileEventHandler {

    private final FileManager fileManager;

    /**
     * íŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤.
     * */
    @EventListener
    public void handle(FileEvent event) {
        List<FileVO> files = event.getFiles();

        if (files != null)
            fileManager.deleteFile(files);
    }
}
```
* @Component ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ApplicationContextê°€ ì ì ˆí•œ í•¸ë“¤ëŸ¬ë¥¼ í˜¸ì¶œ í•  ìˆ˜ ìˆë„ë¡ ë¹ˆì— ë“±ë¡í•œë‹¤.

3. ApplicationContext ì„ í†µí•´ ì´ë²¤íŠ¸ ë°œìƒì‹œí‚¤ê¸°
```java
... ì¤‘ëµ
} catch (RuntimeException e) {
    // ì¤‘ê°„ì— ì—ëŸ¬ê°€ ë‚œ ê²½ìš° ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.
    applicationContext.publishEvent(new FileEvent(files));

    throw e;
}
```

